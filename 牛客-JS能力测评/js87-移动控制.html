<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      table.game {
        font-size: 14px;
        border-collapse: collapse;
        width: 100%;
        table-layout: fixed;
      }
      table.game td {
        border: 1px solid #e1e1e1;
        padding: 0;
        height: 30px;
        text-align: center;
      }
      table.game td.current {
        background: #1890ff;
      }
    </style>
  </head>
  <body>
    <div id="jsContainer">
      <table class="game">
        <tbody>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td class="current"></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
        </tbody>
      </table>
    </div>
    <script>
      function bind() {
        document.onkeydown = (event) => {
          // console.log("down");
          if (!event) return;
          var code = event.keyCode || "";
          if (!{ 37: 1, 38: 1, 39: 1, 40: 1 }[code]) return;
          event.preventDefault && event.preventDefault();
          //TODO: 请实现按键控制

          let current = document.querySelector(".current");
          let rows = document.querySelector("tbody").rows;
          let rowNum = rows.length;
          let currentTr = current.closest("tr");
          let colNum = currentTr.cells.length;
          
          let currentRow = currentTr.rowIndex;
          let currentCol = current.cellIndex;

          console.log(rowNum, colNum, currentRow, currentCol);

          switch (code) {
            case 38:
              currentRow = changeIndex(currentRow, rowNum, -1);
              break;
            case 40:
              currentRow = changeIndex(currentRow, rowNum, 1);
              break;
            case 37:
              currentCol = changeIndex(currentCol, colNum, -1);
              break;
            case 39:
              currentCol = changeIndex(currentCol, colNum, 1);
              break;
          }

          console.log(rowNum, colNum, currentRow, currentCol);

          current.className = "";
          rows[currentRow].cells[currentCol].className = "current";
        };
      }


      bind();

      function changeIndex(index, indexMax, change) {
        if(change > 0) {
          index = index + 1 > indexMax - 1 ? 0 : index + 1;
        } else {
          index = index - 1 < 0 ? indexMax - 1 : index - 1;
        }
        return index;
      }
    </script>
  </body>
</html>
